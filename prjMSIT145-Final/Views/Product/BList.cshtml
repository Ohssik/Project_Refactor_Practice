@{
	ViewData["Title"] = "BList";
}
@section Styles{
	<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.1/css/jquery.dataTables.css">
	<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.13.1/js/jquery.dataTables.js"></script>
	<script src="../js/ProductList.js"> </script>
	<link rel="stylesheet" href="../css/ProductList.css">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
}
<h1>BList</h1>
<div>
	<div class="top">
		<div>
			<h2 id="h2">餐點</h2>
		</div>
		<div class="topbutton">
			<input class="insertbutton" type="button" value="+新增餐點" id="btnCreateProduct" />
			<input class="insertbutton" type="button" value="+新增類別" id="btnCreateType" />
		</div>
	</div>
	<<input class="inserselecttext" type="text" placeholder="搜尋...." id="txtKeyword" />
	<!-- <select ><option></option></select>
	 -->
	<table id="table" class="table table-hover stripe">
		<thead>
		<th>相片</th>
		<th>名稱</th>
		<th>價格</th>
		<th>類別</th>
		<th>備註</th>
		<th>刪除編輯</th>
		</thead>
		<tbody id="tbody">
			@*<tr>
				<td><input type="image" src="../images/uparrow.png"></td>
				<td>花枝排</td>
				<td>70.00</td>
				<td>小菜類</td>
				<td>-</td>
				<td>
					<button class="buteditgar"><img src="../images/garbage.png"></button>
					<button class="buteditgar"><img src="../images/edit.png"></button>
				</td>

			</tr>
			<tr>
				<td><input type="image" src="../images/uparrow.png"></td>
				<td>豬排</td>
				<td>70.00</td>
				<td>主菜類</td>
				<td>-</td>
				<td>
					<button class="buteditgar"><img src="../images/garbage.png"></button>
					<button class="buteditgar"><img src="../images/edit.png"></button>
				</td>

			</tr>
			<tr>
				<td><input type="image" src="../images/uparrow.png"></td>
				<td>雞排</td>
				<td>80.00</td>
				<td>炸物類</td>
				<td>-</td>
				<td>
					<button class="buteditgar"><img src="../images/garbage.png"></button>
					<button class="buteditgar"><img src="../images/edit.png"></button>
				</td>

			</tr>
			<tr>
				<td><input type="image" src="../images/uparrow.png"></td>
				<td>牛排</td>
				<td>100.00</td>
				<td>主菜類</td>
				<td>-</td>
				<td>
					<button class="buteditgar"><img src="../images/garbage.png"></button>
					<button class="buteditgar"><img src="../images/edit.png"></button>
				</td>

			</tr>
			<tr>
				<td><input type="image" src="../images/uparrow.png"></td>
				<td>雞塊</td>
				<td>75.00</td>
				<td>炸物類</td>
				<td>-</td>
				<td>
					<button class="buteditgar"><img src="../images/garbage.png"></button>
					<button class="buteditgar"><img src="../images/edit.png"></button>
				</td>

			</tr>
			<tr>
				<td><input type="image" src="../images/uparrow.png"></td>
				<td>薯條</td>
				<td>80.00</td>
				<td>炸物類</td>
				<td>-</td>
				<td>
					<button class="buteditgar"><img src="../images/garbage.png"></button>
					<button class="buteditgar"><img src="../images/edit.png"></button>
				</td>

			</tr>
			<tr>
				<td><input type="image" src="../images/uparrow.png"></td>
				<td>珍珠奶茶</td>
				<td>60.00</td>
				<td>飲料類</td>
				<td>-</td>
				<td>
					<button class="buteditgar"><img src="../images/garbage.png"></button>
					<button class="buteditgar"><img src="../images/edit.png"></button>
				</td>

			</tr>
			<tr>
				<td><input type="image" src="../images/uparrow.png"></td>
				<td>烏龍綠茶</td>
				<td>60.00</td>
				<td>飲料類</td>
				<td>-</td>
				<td>
					<button class="buteditgar"><img src="../images/garbage.png"></button>
					<button class="buteditgar"><img src="../images/edit.png"></button>
				</td>

			</tr>*@
		</tbody>
	</table>
</div>
@section Scripts{
	<script>
		const txt = document.querySelector("#txtKeyword");
		const tbody = document.querySelector("#tbody");
		const btnCreateProduct = document.querySelector("#btnCreateProduct");

		//關鍵字查詢(類別與商品)
		txt.addEventListener("keyup", () => search());

		search();
		async function search() {
			let response = await fetch(`@Url.Content("~/Product/BSearch?keyword=${txt.value}")`);
			const datas = await response.json();
			let result = document.createDocumentFragment();

			datas.forEach(function (index, proCategory,product) {
				result += `<tr>
								<input type="hidden" name="${product.fid}" value="${product.fid}" id="${product.fid}"/>
								<input type="hidden" name="${productbFid}" value="${product.bFid}"/>
						<input type="hidden" name="${product.categoryFid}" value="${product.categoryFid}"/>

						<td><input type="image" src="../images/uparrow.png"></td>
								<td>${product.productName}</td>
						<td>${product.unitPrice}</td>
						<td>${proCategory.categoryName}</td>
						<td>-</td>
						<td>
							<button class="buteditgar"><img src="../images/garbage.png" id='btnEdit'>編輯</button>
							<button class="buteditgar"><img src="../images/edit.png" id='btnDelete'>刪除</button>
						</td>
					</tr>`
			});
			tbody.innerHTML = result;
		}
	</script>
}
