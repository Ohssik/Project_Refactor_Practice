@model List<prjMSIT145_Final.ViewModels.VBusinessMemberContainImgViewModel>
@{
    Layout = "_CustomerLayout";
    ViewData["Title"] = "Home Page";
}
@section Styles{
    <link href="~/css/Customer_css/CMainpagestyle.css" rel="stylesheet" />
    <link href="~/css/Customer_css/CShopcardstyle.css" rel="stylesheet" />
    <style>
        .wrapper {
            position: relative;
            width: 70%;
           /* width: 800px;
            height: 300px;*/
            height: 95%;
            overflow: hidden;
            margin: 10px auto;
        }      

        ul.slides {
            margin: 0;
            padding: 0;
            position: absolute;
            width: 4860px;
            left: 0px;
            transition: all .5s;
        }

        ul.slides li {
            margin: 0;
            padding: 0;
            list-style: none;
            width: 540px;
            height: 360px;
            overflow: hidden;
            float: left;
        }

        ul.slides li img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
    </style>
}
<section class="Displayarea">
    <div class="ADblock">
        <img src="~/images/Customer/Mainpage/shibaLogo_row2.png" />

        @*廣告輪播*@
        <div class="wrapper">
            <ul class="slides">                                      
            </ul>                
        </div>

    </div>
    <div class="Bone Boneposition1">
        <div class="Quickbutton">
            <img src="~/images/Customer/Mainpage/nearby 64x64.png" />
        </div>
        <p>找附近</p>
    </div>
    <div class="Bone Boneposition2">
        <div class="Quickbutton">
            <img src="~/images/Customer/Mainpage/findarea 64x64.png" />
        </div>
        <p>找區域</p>
    </div>
    <div class="Bone Boneposition3">
        <div class="Quickbutton">
            <img src="~/images/Customer/Mainpage/shop 64x64.png" />
        </div>
        <p>找品牌</p>
    </div>
    <div class="Bone Boneposition4">
        <div class="Quickbutton">
            <img src="~/images/Customer/Mainpage/coupon 64x64.png" />
        </div>
        <p>我的券夾</p>
    </div>
</section>
<section class="Showshoptilte">
    <p>專屬推薦店家</p>
    <div>
        <h2>查看更多&ensp;</h2>
        <img src="~/images/Customer/Mainpage/circlearrow_right 32x32.png" />
    </div>
</section>
<section class="Showshopdisplay">
    @{
        foreach (var item in Model)
        {
            if (item.IsSuspensed == 0)
            {
                if (item.IsOpened > 0)
                {
                    @if (item.IsOpened == 1)
                    {
                        <div class="Shopcard CursorPointer" id="Shop @item.Fid">
                            <img class="Shopcardcover" src="~/images/Customer/Shopcard/Test/shopcover.png" />
                            <img class="Shopcardloggo" src="~/images/Customer/Shopcard/Test/circlelogo.png" />
                            <div class="Shopcardbottem">
                                <h3>&ensp;@item.MemberName</h3>
                                <ul>
                                    <li>&ensp;@item.OpenTime&ensp;～&ensp;@item.CloseTime&ensp;</li>
                                    <li>&ensp;0.3 km&ensp;</li>
                                    <li>&ensp;★ 4.6&ensp;</li>
                                </ul>
                                <h4>&ensp;@item.Address</h4>
                            </div>
                        </div>
                    }
                    @if (item.IsOpened == 2)
                    {
                        <div class="Shopcard CursorDefault" id="Shop @item.Fid">
                            <img class="Shopcardcover" src="~/images/Customer/Shopcard/Test/shopcover.png" />
                            <img class="Shopcardloggo" src="~/images/Customer/Shopcard/Test/circlelogo.png" />
                            <div class="ShopisClose">暫停接單</div>
                            <div class="Shopcardbottem">
                                <h3>&ensp;@item.MemberName</h3>
                                <ul>
                                    <li>&ensp;@item.OpenTime&ensp;～&ensp;@item.CloseTime&ensp;</li>
                                    <li>&ensp;0.3 km&ensp;</li>
                                    <li>&ensp;★ 4.6&ensp;</li>
                                </ul>
                                <h4>&ensp;@item.Address</h4>
                            </div>
                        </div>
                    }
                }
            }
        }
    }
</section>
@section Scripts{
    <script>
        
        @foreach (var item in Model)
        {
            if (item.IsSuspensed == 0)
            {
                @if (item.IsOpened == 1)
                {
                    @:document.getElementById("Shop @(item.Fid)").addEventListener("click", function () {
                    @:location.href="/Home/CShowProduct?BFid=@(item.Fid)";
                    @:});
                }
            }
        }
        $(function () { 
            let slideNum = 0;
            let slideCount = $(".slides li").length;
            let lastIndex = slideCount - 1;
            
            let si = setInterval(() => {
                slideNum = ((new Date()).getSeconds()) % 9;
                let slidemove = -540 * slideNum;
                $('ul.slides').css('left', slidemove);
            },1000);
            
            $.ajax({
                    url: `@Url.Content("~/home/CgetAdImgList")`,
                    type:'post',
                    data:{},
                    dataType:'json',
                    success:function(data){
                        //console.log(data);
                        let docFrag=document.createDocumentFragment();
                        $(data).each(function(i,value){
                            $(docFrag).append(`<li><img src='@Url.Content("~/adminImg/adDisplay/")${value.imgName}' /></li>`);
                        });
                        $('ul.slides').append(docFrag);
                    }                    
            });
            
        });
    </script>
}