@model List<prjMSIT145_Final.ViewModels.VCUtilityViewModel>
@{
    Layout = "_CustomerLayout";
    ViewData["Title"] = "CShowProduct";
}
@section Styles{
    <link href="~/css/Customer_css/CBSonlyClass.css" rel="stylesheet" />
    <link href="~/css/Customer_css/CShowProduct.css" rel="stylesheet" />
}
<section class="shopinfocard">
    <div class="shopinfoarea">
        <div class="shopinfo">
            <img class="Shoplogo" src="~/images/Customer/Shopcard/Test/circlelogo.png" />
            <div>
                <div class="shoptitle">@Model[0].BusinessMemberDetailList[0].MemberName</div>
                <div class="infoblock">
                    <div class="InfoArea">店家資訊</div>
                    <div class="InfoArea">
                        <img src="~/images/Customer/ShowProduct/Ystar 16x16.png" />
                        <img src="~/images/Customer/ShowProduct/Ystar 16x16.png" />
                        <img src="~/images/Customer/ShowProduct/Ystar 16x16.png" />
                        <img src="~/images/Customer/ShowProduct/Ystar 16x16.png" />
                        <img src="~/images/Customer/ShowProduct/Nstar 16x16.png" />
                        <p>4.2 (6)</p>
                    </div>
                    <div class="InfoArea"><img src="~/images/Customer/ShowProduct/opentime 20x20.png" /><p>@Model[0].BusinessMemberDetailList[0].OpenTime ~ @Model[0].BusinessMemberDetailList[0].CloseTime</p></div>
                    <div class="InfoArea"><img src="~/images/Customer/ShowProduct/phone 20x20.png" /><p>@Model[0].BusinessMemberDetailList[0].Phone</p></div>
                    <div class="InfoArea"><img src="~/images/Customer/ShowProduct/address 20x20.png" /><p>@Model[0].BusinessMemberDetailList[0].Address</p></div>
                    <div class="InfoArea"><img src="~/images/Customer/ShowProduct/paymentterm 20x20.png" /><p>@Model[0].PaymenttermList[0].PaymentType</p></div>
                </div>
            </div>
        </div>
        <div class="btnbar">
            <div class="iconwrap">
                <div class="icon">
                    <img src="~/images/Customer/ShowProduct/discount 24x24.png" />
                </div>
                <div class="btntext">優惠</div>
            </div>
            <div class="iconwrap">
                <div class="icon">
                    <img src="~/images/Customer/ShowProduct/take 24x24.png" />
                </div>
                <div class="btntext">怎取餐</div>
            </div>
            <div class="iconwrap">
                <div class="icon">
                    <img src="~/images/Customer/ShowProduct/search 24x24.png" />
                </div>
                <div class="btntext">找商品</div>
            </div>
            <div class="iconwrap">
                <div class="icon">
                    <img src="~/images/Customer/ShowProduct/add 24x24.png" />
                </div>
                <div class="btntext">揪團</div>
            </div>
        </div>
    </div>
    <section class="ADarea">
        <img class="Shopcardcover" src="~/images/Customer/Shopcard/Test/shopcover.png" />
    </section>
</section>

<section class="ShowClassdisplay">
    <div class="ShowClassregion">
        @{
            foreach (var item1 in Model[0].ProductClassList)
            {
                if (item1.ProductsList.Count != 0)
                {
                    if (item1.PlayregionID == 1)
                    {
                        <div class="productclass">
                            <h1 class="classtitle">@item1.CategoryName</h1>
                            @foreach (var item2 in item1.ProductsList)
                            {
                                @if (item2.IsForSale != 0)
                                {
                                    @if (item2.IsForSale == 1)
                                    {
                                        <div class="productitem CursorPointer" id="Prod @item2.Fid" data-bs-toggle="modal" data-bs-target="#OptionModal">
                                            <div class="PhotoandName">
                                                <img src="~/images/@item2.Photo">
                                                <p>@item2.ProductName</p>
                                                @if (@item2.OrdetAmount > 0)
                                                {
                                                    <div class="AmountBall">@item2.OrdetAmount</div>
                                                }
                                            </div>
                                            <p class="producttext">$ @Convert.ToInt32(item2.UnitPrice)</p>
                                        </div>
                                    }
                                    else
                                    {
                                        <div class="productitem CursorDefault">
                                            <div class="PhotoandName">
                                                <img src="~/images/@item2.Photo">
                                                <p>@item2.ProductName</p>
                                                @if (@item2.OrdetAmount > 0)
                                                {
                                                    <div class="AmountBall">@item2.OrdetAmount</div>
                                                }
                                            </div>
                                            <p class="productNotsale">停售</p>
                                        </div>
                                    }
                                }
                            }
                        </div>
                    }
                }
            }
        }
    </div>
    <div class="ShowClassregion">
        @{
            foreach (var item1 in Model[0].ProductClassList)
            {
                if (item1.ProductsList.Count != 0)
                {
                    if (item1.PlayregionID == 2)
                    {
                        <div class="productclass">
                            <h1 class="classtitle">@item1.CategoryName</h1>
                            @foreach (var item2 in item1.ProductsList)
                            {
                                @if (item2.IsForSale != 0)
                                {
                                    @if (item2.IsForSale == 1)
                                    {
                                        <div class="productitem CursorPointer" id="Prod @item2.Fid" data-bs-toggle="modal" data-bs-target="#OptionModal">
                                            <div class="PhotoandName">
                                                <img src="~/images/@item2.Photo">
                                                <p>@item2.ProductName</p>
                                                @if (@item2.OrdetAmount > 0)
                                                {
                                                    <div class="AmountBall">@item2.OrdetAmount</div>
                                                }
                                            </div>
                                            <p class="producttext">$ @Convert.ToInt32(item2.UnitPrice)</p>
                                        </div>
                                    }
                                    else
                                    {
                                        <div class="productitem CursorDefault">
                                            <div class="PhotoandName">
                                                <img src="~/images/@item2.Photo">
                                                <p>@item2.ProductName</p>
                                                @if (@item2.OrdetAmount > 0)
                                                {
                                                    <div class="AmountBall">@item2.OrdetAmount</div>
                                                }
                                            </div>
                                            <p class="productNotsale">停售</p>
                                        </div>
                                    }
                                }
                            }
                        </div>
                    }
                }
            }
        }
    </div>
    <div class="ShowClassregion">
        @{
            foreach (var item1 in Model[0].ProductClassList)
            {
                if (item1.ProductsList.Count != 0)
                {
                    if (item1.PlayregionID == 3)
                    {
                        <div class="productclass">
                            <h1 class="classtitle">@item1.CategoryName</h1>
                            @foreach (var item2 in item1.ProductsList)
                            {
                                @if (item2.IsForSale != 0)
                                {
                                    @if (item2.IsForSale == 1)
                                    {
                                        <div class="productitem CursorPointer" id="Prod @item2.Fid" data-bs-toggle="modal" data-bs-target="#OptionModal">
                                            <div class="PhotoandName">
                                                <img src="~/images/@item2.Photo">
                                                <p>@item2.ProductName</p>
                                                @if (@item2.OrdetAmount > 0)
                                                {
                                                    <div class="AmountBall">@item2.OrdetAmount</div>
                                                }
                                            </div>
                                            <p class="producttext">$ @Convert.ToInt32(item2.UnitPrice)</p>
                                        </div>
                                    }
                                    else
                                    {
                                        <div class="productitem CursorDefault">
                                            <div class="PhotoandName">
                                                <img src="~/images/@item2.Photo">
                                                <p>@item2.ProductName</p>
                                                @if (@item2.OrdetAmount > 0)
                                                {
                                                    <div class="AmountBall">@item2.OrdetAmount</div>
                                                }
                                            </div>
                                            <p class="productNotsale">停售</p>
                                        </div>
                                    }
                                }
                            }
                        </div>
                    }
                }
            }
        }
    </div>
</section>

<!-- FormArea -->
<form asp-controller="" asp-action="" method="post" enctype="multipart/form-data">
    <input type="text" name="BFid" id="BFid" value="@Model[0].BusinessMemberDetailList[0].Fid" />
    <input type="text" name="PFid" id="PFid" value="無變化" />
    <div style="height:500px;width:500px;background-color:aqua;"></div>
    <!-- Modal -->
    <div class="modal fade" id="OptionModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
            <div class="modal-content">

                <div class="modal-header">
                    <h2 class="ModalTitle" id="ProductTitle">標題</h2>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <div class="modal-body" id="OptionDisplayArea">
                    <img id="ProductPhoto" class="ProductPhoto" src="~/images/Customer/Mainpage/shibaLogo_row2.png" />
                    <p class="OptionGroupTitle"><span class="NeedChoose">✱</span>尺寸</p>
                    <div class="OptionsArea">
                        <div class="Optiondiv"><p>大大大大大大</p><p>大大大大大大</p></div>
                        <div class="Optiondiv"><p>大大大大大大</p><p>大大大大大大</p></div>
                        <div class="Optiondiv"><p>大大大大大大</p><p>大大大大大大</p></div>
                        <div class="Optiondiv"><p>大大大大大大</p><p>大大大大大大</p></div>
                    </div>
                    <p class="OptionGroupTitle"><span class="NeedChoose">✱</span>尺寸</p>
                    <div class="OptionsArea">
                        <div class="Optiondiv"><p>大大大大大大</p><p>大大大大大大</p></div>
                        <div class="Optiondiv"><p>大大大大大大</p><p>大大大大大大</p></div>
                        <div class="Optiondiv"><p>大大大大大大</p><p>大大大大大大</p></div>
                        <div class="Optiondiv"><p>大大大大大大</p><p>大大大大大大</p></div>
                    </div>
                </div>

                <div class="modal-footer">
                    <div class="DisplayColumn">
                        <p class="TotalPrice">總金額：︁<span class="TotalPrice"> 60 </span>元</p>
                        <div class="DisplayFlex">
                            <div class="Minusbtn">-</div>
                            <div class="Countbtn">99</div>
                            <div class="Plusbtn">+</div>
                        </div>
                    </div>
                    <button type="button" class="Submitbtn">加入購物車</button>
                </div>

            </div>
        </div>
    </div>
</form>


@section Scripts{
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let OptionDisplayArea = document.getElementById('OptionDisplayArea');

        @foreach (var item1 in Model[0].ProductClassList)
        {
            @if (item1.ProductsList.Count != 0)
            {
                @foreach (var item2 in item1.ProductsList)
                {
                    @if (item2.IsForSale == 1)
                    {
                        @:document.getElementById("Prod @(item2.Fid)").addEventListener("click", function () {
                        @:document.getElementById("PFid").value=@(item2.Fid);
                        @:document.getElementById("ProductTitle").innerHTML="@(item2.ProductName)";
                        @:getOptiondatas();
                        @:});
                    }
                }
            }
        }

            async function getOptiondatas() {
                const response = await fetch("@Url.Content("~/Home/CShowProductOption?PFid=1")");
                const datas = await response.json();
                STRdatas = JSON.stringify(datas);
                console.log(datas);
                console.log(datas[0]);
                console.log(datas[0].ProductBasicInfoList[0].fid);
                //OptionDisplayArea.innerHTML += STRdatas;
            }
    </script>
}

